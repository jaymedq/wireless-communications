<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Assignment3</title>
<meta name="generator" content="MATLAB 23.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-07-01">
<meta name="DC.source" content="Assignment3.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Quest&atilde;o 1</a>
</li>
<li>
<a href="#2">Quest&atilde;o 2</a>
</li>
<li>
<a href="#3">Quest&atilde;o 3</a>
</li>
<li>
<a href="#4">Quest&atilde;o 4</a>
</li>
</ul>
</div>
<h2 id="1">Quest&atilde;o 1</h2>
<pre class="codeinput">
<span class="comment">%{
</span><span class="comment">Seja Pr(d0)=1 mW para d0=1 m, trace a probabilidade de outage em fun&ccedil;&atilde;o da
</span><span class="comment">dist&acirc;ncia, para dist&acirc;ncias variando de 1 a 100 metros, supondo modelo
</span><span class="comment">log-dist&acirc;ncia com expoente 4, B=10 MHz, Rb=10 Mbps, N0=&minus;204 dB/Hz,
</span><span class="comment">fc=3 GHz, Rayleigh e Nakagami-m com m=2.
</span><span class="comment">%}
</span><span class="comment">%Tendo a potencia recebida, calcula SNR e depois calcula Probabilidade de outage.</span>
<span class="comment">% Defini&ccedil;&otilde;es e Par&acirc;metros</span>
clc;
close <span class="string">all</span>;
clear;
Pr_d0 = 1e-3; <span class="comment">% Pot&ecirc;ncia recebida a d0 (1 mW = 1e-3 W)</span>
d0 = 1; <span class="comment">% Dist&acirc;ncia de refer&ecirc;ncia (1 m)</span>
B = 10e6; <span class="comment">% Largura de banda (10 MHz)</span>
Rb = 10e6; <span class="comment">% Taxa de bits (10 Mbps)</span>
N0_dB = -204; <span class="comment">% Densidade espectral de ru&iacute;do em dB/Hz</span>
fc = 3e9; <span class="comment">% Frequ&ecirc;ncia de portadora (3 GHz)</span>
m = 2; <span class="comment">% Par&acirc;metro Nakagami-m</span>

<span class="comment">% Convers&otilde;es e c&aacute;lculos iniciais</span>
N0 = 10^(N0_dB / 10); <span class="comment">% Convers&atilde;o de dB/Hz para linear</span>
N = N0 * B; <span class="comment">% Pot&ecirc;ncia de ru&iacute;do total</span>
distances = 1:100; <span class="comment">% Dist&acirc;ncias variando de 1 a 100 metros</span>

<span class="comment">% Pot&ecirc;ncia recebida (modelo de log-dist&acirc;ncia com expoente 4)</span>
Pr = Pr_d0 * ((d0 ./ distances).^4);

<span class="comment">% SNR em cada dist&acirc;ncia</span>
SNR = Pr / N;

<span class="comment">% Limiar de SNR para a taxa de bits desejada (considerando Shannon)</span>
SNR_threshold = (2^(Rb / B) - 1);

<span class="comment">% Probabilidade de outage para Rayleigh</span>
P_out_Rayleigh = 1 - exp(-SNR_threshold ./ SNR);

<span class="comment">% Probabilidade de outage para Nakagami-m usando a fun&ccedil;&atilde;o gama incompleta</span>
arg = m * SNR_threshold ./ SNR;
P_out_Nakagami = gammainc(arg, m, <span class="string">'lower'</span>) / gamma(m);

<span class="comment">% Aproxima&ccedil;&atilde;o da probabilidade de outage para Nakagami-m</span>
P_out_Nakagami_approx = (arg.^m) / gamma(m + 1);

<span class="comment">% Plotando os resultados</span>
figure;
semilogy(distances, P_out_Rayleigh, <span class="string">'b-'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">on</span>;
semilogy(distances, P_out_Nakagami, <span class="string">'r-'</span>, <span class="string">'LineWidth'</span>, 3);
semilogy(distances, P_out_Nakagami_approx, <span class="string">'g-.'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
grid <span class="string">on</span>;
xlabel(<span class="string">'Dist&acirc;ncia (m)'</span>);
ylabel(<span class="string">'Probabilidade de Outage'</span>);
legend(<span class="string">'Rayleigh'</span>, <span class="string">'Nakagami-m (m=2)'</span>, <span class="string">'Nakagami-m (m=2) aprox'</span>);
title(<span class="string">'Probabilidade de Outage em fun&ccedil;&atilde;o da Dist&acirc;ncia'</span>);
</pre>
<img vspace="5" hspace="5" src="Assignment3_01.png" alt=""> <h2 id="2">Quest&atilde;o 2</h2>
<pre class="codeinput">
<span class="comment">%{
</span><span class="comment">A probabilidade de outage varia muito com a parcela de linha de visada
</span><span class="comment">(aumento de m). Como seria a outage para o caso do canal AWGN? O canal
</span><span class="comment">sem fio em NLOS fica muito distante deste desempenho. Como melhorar o
</span><span class="comment">desempenho do canal sem fio neste cen&aacute;rio de canal lento (outage)?
</span><span class="comment">%}
</span><span class="comment">%Quest&atilde;o 2 - AWGN &eacute; Poutage 0, para melhoar ler no livro.</span>
clear;
disp(<span class="string">'A probabilidade de outage no canal AWGN &eacute; 0. Em um canal sem '</span>)
disp(<span class="string">'fio em NLOS &eacute; poss&iacute;vel melhorar o desempenho, em rela&ccedil;&atilde;o ao '</span>)
disp(<span class="string">'outage utilizando t&eacute;cnicas de diversidade do canal (MIMO e OFDM).'</span>)
</pre>
<pre class="codeoutput">A probabilidade de outage no canal AWGN &eacute; 0. Em um canal sem 
fio em NLOS &eacute; poss&iacute;vel melhorar o desempenho, em rela&ccedil;&atilde;o ao 
outage utilizando t&eacute;cnicas de diversidade do canal (MIMO e OFDM).
</pre>
<h2 id="3">Quest&atilde;o 3</h2>
<pre class="codeinput">
<span class="comment">%{
</span><span class="comment">Reproduza a Figura 4.2: Normalized Capacity (C/B) versus Outage
</span><span class="comment">Probability, do livro da Goldsmith. Trace tamb&eacute;m a capacidade com
</span><span class="comment">outage normalizada Co/B, em fun&ccedil;&atilde;o da probabilidade de outage.
</span><span class="comment">
</span><span class="comment">Obs.: Ao plotar Co/B, limite o eixo x (probabilidade de outage)
</span><span class="comment">de 10&minus;4 at&eacute; 100.
</span><span class="comment">%}
</span>clear;
<span class="comment">% Definir o SNR m&eacute;dio em escala linear (20 dB)</span>
SNRMed_Db = 20;
SNRMed = 10^(SNRMed_Db / 10);

<span class="comment">% Definir a faixa de probabilidade de outage</span>
pout = logspace(-4, 0, 1000);

<span class="comment">% Calcular gamma_min para cada probabilidade de outage</span>
SNRMin = -SNRMed * log(1 - pout);

<span class="comment">% Calcular capacidade normalizada C/B</span>
C_B = log2(1 + SNRMin);

<span class="comment">% Calcular capacidade normalizada com outage Co/B</span>
Co_B = (1 - pout) .* C_B;

<span class="comment">% Plotar os resultados</span>
figure;
xlim([1e-4 1]);
ylim([0 4]);
semilogx(pout, C_B, <span class="string">'DisplayName'</span>, <span class="string">'C/B'</span>);
hold <span class="string">on</span>;
semilogx(pout, Co_B, <span class="string">'DisplayName'</span>, <span class="string">'Co/B'</span>);
xlabel(<span class="string">'Probabilidade de Outage'</span>);
ylabel(<span class="string">'Capacidade Normalizada (C/B)'</span>);
title(<span class="string">'Capacidade Normalizada (C/B) e (Co/B) versus Probabilidade de Outage'</span>);
legend <span class="string">show</span>;
grid <span class="string">on</span>;
</pre>
<img vspace="5" hspace="5" src="Assignment3_02.png" alt=""> <h2 id="4">Quest&atilde;o 4</h2>
<pre class="codeinput">
<span class="comment">%{
</span><span class="comment">Fa&ccedil;a uma an&aacute;lise semelhante a da Figura 4.2, mas agora mostrando a
</span><span class="comment">capacidade com outage normalizada (Co/B) versus γ&macr;&macr;&macr; para algumas
</span><span class="comment">probabilidades de outage.
</span><span class="comment">%}
</span><span class="comment">%C = (1-Pout)*B*log2(1+SNRMin)</span>
<span class="comment">%Pout depende de SNR, substitua dependendo do SNR instantaneo,  defina um vetor de SNR e plote C.</span>

clear;

<span class="comment">% Definir a faixa de valores para o SNR instant&acirc;neo (em dB)</span>
SNR_dB = linspace(0, 30, 1000);
SNR = 10.^(SNR_dB / 10);

<span class="comment">% Definir algumas probabilidades de outage</span>
pout_vals = [0.01 0.05 0.1 0.99];

<span class="comment">% Preparar o plot</span>
figure;
hold <span class="string">on</span>;

<span class="comment">% Calcular e plotar C/B para cada probabilidade de outage</span>
<span class="keyword">for</span> pout = pout_vals
    <span class="comment">% Calcular gamma_min para a probabilidade de outage dada</span>
    SNRMin = -SNR .* log(1 - pout);

    <span class="comment">% Calcular capacidade normalizada C/B</span>
    C_B = log2(1 + SNRMin);

    <span class="comment">% Calcular capacidade normalizada com outage Co/B</span>
    Co_B = (1 - pout) .* C_B;

    <span class="comment">% Plotar capacidade normalizada com outage Co/B</span>
    plot(SNR_dB, Co_B, <span class="string">'DisplayName'</span>, [<span class="string">'p_{out} = '</span> num2str(pout)]);
<span class="keyword">end</span>

<span class="comment">% Configurar o gr&aacute;fico</span>
xlabel(<span class="string">'SNR Instant&acirc;neo (\gamma) [dB]'</span>);
ylabel(<span class="string">'Capacidade Normalizada com Outage (C_o/B)'</span>);
title(<span class="string">'Capacidade Normalizada com Outage (C_o/B) versus SNR Instant&acirc;neo (\gamma)'</span>);
legend <span class="string">show</span>;
grid <span class="string">on</span>;
hold <span class="string">off</span>;
</pre>
<img vspace="5" hspace="5" src="Assignment3_03.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Questão 1
%{
Seja Pr(d0)=1 mW para d0=1 m, trace a probabilidade de outage em função da 
distância, para distâncias variando de 1 a 100 metros, supondo modelo 
log-distância com expoente 4, B=10 MHz, Rb=10 Mbps, N0=−204 dB/Hz, 
fc=3 GHz, Rayleigh e Nakagami-m com m=2.
%}
%Tendo a potencia recebida, calcula SNR e depois calcula Probabilidade de outage.
% Definições e Parâmetros
clc;
close all;
clear;
Pr_d0 = 1e-3; % Potência recebida a d0 (1 mW = 1e-3 W)
d0 = 1; % Distância de referência (1 m)
B = 10e6; % Largura de banda (10 MHz)
Rb = 10e6; % Taxa de bits (10 Mbps)
N0_dB = -204; % Densidade espectral de ruído em dB/Hz
fc = 3e9; % Frequência de portadora (3 GHz)
m = 2; % Parâmetro Nakagami-m

% Conversões e cálculos iniciais
N0 = 10^(N0_dB / 10); % Conversão de dB/Hz para linear
N = N0 * B; % Potência de ruído total
distances = 1:100; % Distâncias variando de 1 a 100 metros

% Potência recebida (modelo de log-distância com expoente 4)
Pr = Pr_d0 * ((d0 ./ distances).^4);

% SNR em cada distância
SNR = Pr / N;

% Limiar de SNR para a taxa de bits desejada (considerando Shannon)
SNR_threshold = (2^(Rb / B) - 1);

% Probabilidade de outage para Rayleigh
P_out_Rayleigh = 1 - exp(-SNR_threshold ./ SNR);

% Probabilidade de outage para Nakagami-m usando a função gama incompleta
arg = m * SNR_threshold ./ SNR;
P_out_Nakagami = gammainc(arg, m, 'lower') / gamma(m);

% Aproximação da probabilidade de outage para Nakagami-m
P_out_Nakagami_approx = (arg.^m) / gamma(m + 1);

% Plotando os resultados
figure;
semilogy(distances, P_out_Rayleigh, 'b-', 'LineWidth', 2);
hold on;
semilogy(distances, P_out_Nakagami, 'r-', 'LineWidth', 3);
semilogy(distances, P_out_Nakagami_approx, 'g-.', 'LineWidth', 2);
hold off;
grid on;
xlabel('Distância (m)');
ylabel('Probabilidade de Outage');
legend('Rayleigh', 'Nakagami-m (m=2)', 'Nakagami-m (m=2) aprox');
title('Probabilidade de Outage em função da Distância');

%% Questão 2
%{
A probabilidade de outage varia muito com a parcela de linha de visada 
(aumento de m). Como seria a outage para o caso do canal AWGN? O canal 
sem fio em NLOS fica muito distante deste desempenho. Como melhorar o 
desempenho do canal sem fio neste cenário de canal lento (outage)?
%}
%Questão 2 - AWGN é Poutage 0, para melhoar ler no livro.
clear;
disp('A probabilidade de outage no canal AWGN é 0. Em um canal sem ')
disp('fio em NLOS é possível melhorar o desempenho, em relação ao ')
disp('outage utilizando técnicas de diversidade do canal (MIMO e OFDM).')

%% Questão 3
%{
Reproduza a Figura 4.2: Normalized Capacity (C/B) versus Outage 
Probability, do livro da Goldsmith. Trace também a capacidade com 
outage normalizada Co/B, em função da probabilidade de outage. 

Obs.: Ao plotar Co/B, limite o eixo x (probabilidade de outage) 
de 10−4 até 100.
%}
clear;
% Definir o SNR médio em escala linear (20 dB)
SNRMed_Db = 20;
SNRMed = 10^(SNRMed_Db / 10);

% Definir a faixa de probabilidade de outage
pout = logspace(-4, 0, 1000);

% Calcular gamma_min para cada probabilidade de outage
SNRMin = -SNRMed * log(1 - pout);

% Calcular capacidade normalizada C/B
C_B = log2(1 + SNRMin);

% Calcular capacidade normalizada com outage Co/B
Co_B = (1 - pout) .* C_B;

% Plotar os resultados
figure;
xlim([1e-4 1]);
ylim([0 4]);
semilogx(pout, C_B, 'DisplayName', 'C/B');
hold on;
semilogx(pout, Co_B, 'DisplayName', 'Co/B');
xlabel('Probabilidade de Outage');
ylabel('Capacidade Normalizada (C/B)');
title('Capacidade Normalizada (C/B) e (Co/B) versus Probabilidade de Outage');
legend show;
grid on;





%% Questão 4
%{
Faça uma análise semelhante a da Figura 4.2, mas agora mostrando a 
capacidade com outage normalizada (Co/B) versus γ¯¯¯ para algumas 
probabilidades de outage.
%}
%C = (1-Pout)*B*log2(1+SNRMin)
%Pout depende de SNR, substitua dependendo do SNR instantaneo,  defina um vetor de SNR e plote C.

clear;

% Definir a faixa de valores para o SNR instantâneo (em dB)
SNR_dB = linspace(0, 30, 1000);
SNR = 10.^(SNR_dB / 10);

% Definir algumas probabilidades de outage
pout_vals = [0.01 0.05 0.1 0.99];

% Preparar o plot
figure;
hold on;

% Calcular e plotar C/B para cada probabilidade de outage
for pout = pout_vals
    % Calcular gamma_min para a probabilidade de outage dada
    SNRMin = -SNR .* log(1 - pout);
    
    % Calcular capacidade normalizada C/B
    C_B = log2(1 + SNRMin);
    
    % Calcular capacidade normalizada com outage Co/B
    Co_B = (1 - pout) .* C_B;
    
    % Plotar capacidade normalizada com outage Co/B
    plot(SNR_dB, Co_B, 'DisplayName', ['p_{out} = ' num2str(pout)]);
end

% Configurar o gráfico
xlabel('SNR Instantâneo (\gamma) [dB]');
ylabel('Capacidade Normalizada com Outage (C_o/B)');
title('Capacidade Normalizada com Outage (C_o/B) versus SNR Instantâneo (\gamma)');
legend show;
grid on;
hold off;



##### SOURCE END #####
-->
</body>
</html>
